@model List<StudentEmploymentPortal.Areas.jobpostA.Models.JobPost>
@using StudentEmploymentPortal.Areas.Identity
@using Microsoft.AspNetCore.Identity

@{
    ViewData["Title"] = "Manage Job Posts";
}

<h1 class="mb-4 mt-3">Manage Job Posts</h1>

<form method="post" action="">
    <div class="input-group mb-3">
        <label class="sr-only" for="filterSelect">Filter By:</label>
        <div class="input-group-prepend">
            <span class="input-group-text">Filter By:</span>
        </div>
        <select class="form-control" id="filterSelect">
            <option value="all">All</option>
            <option value="pending">Pending</option>
            <option value="queried">Queried</option>
            <option value="approved">Approved</option>
            <option value="withdrawn">Withdrawn</option>
        </select>
    </div>
</form>

@if (Model != null && Model.Count > 0)
{
    <div class="table-responsive">
        <table class="table table-hover table-default">
            <thead>
                <tr class="table-primary">
                    <th>Job title</th>
                    <th>Department</th>
                    <th>FT/PT</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var jobPost in Model)
                {
                    <tr onclick="openPartialView('@Url.Action("PartialJobPostDetails", "Approver", new { area = "ApproverJ", id = jobPost.JobPostId })')">
                        <td>@jobPost.JobTitle</td>
                        <td>@jobPost.Department</td>
                        <td>@jobPost.JobType</td>
                        <td>@jobPost.StartDate.ToString("MM/dd/yyyy")</td>
                        <td>@jobPost.EndDate.ToString("MM/dd/yyyy")</td>
                        @if (jobPost.ApprovalStatus.ToString() == "Withdrawn")
                        {
                            <td class="text-danger">@jobPost.ApprovalStatus</td>
                        }
                        else if (jobPost.ApprovalStatus.ToString() == "Approved")
                        {
                            <td class="text-success">@jobPost.ApprovalStatus</td>
                        }
                        else
                        {
                            <td>@jobPost.ApprovalStatus</td>
                        }
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
else
{
    <p>You currently don't have any job posts.</p>
}



@section scripts {
    <script>
        $(document).ready(function () {
            $('#filterSelect').on('change', function () {
                var selectedFilter = $(this).val();
                filterRows(selectedFilter);
            });

            function filterRows(filter) {
                $('tbody tr').each(function () {
                    var status = $(this).find('td:nth-child(6)').text();

                    if (filter === 'all' || status.toLowerCase() === filter.toLowerCase()) {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });
            }
        });
    </script>
}